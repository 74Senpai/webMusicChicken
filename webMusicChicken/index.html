<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./resources/styles/keyframe.css">
    <link rel="stylesheet" href="./resources/styles/style.css">
    <title>Music Play</title>
</head>

<body>
    <header>
    </header>
    <div id="container-song">

    </div>
    <script src="https://kit.fontawesome.com/dae763dd72.js" crossorigin="anonymous"></script>
    <script src="./resources/js/app.js"></script>
    <script>

        document.addEventListener("DOMContentLoaded", async function () {
            const app = new MusicApp();
            await app.loadConfig();

            const data = await app.getData('fakeAPI.json');
            let tmp = await Object.keys(data.play_list).length;
            // let dds = songList[0];
            // console.log("sdadad", songList[0].img);
            app.setLengthList(tmp);
            const HTML = (() => {
                let HTMLs = "";
                let songList = data.play_list;
                for (let i = 0; i < tmp; i++) {
                    HTMLs += `
                        <div class="song-tag">
                            <div class="song" data-index=${i}>
                                <audio preload="none">
                                    <source src="${songList[i].audio_src}" type="audio/ogg">
                                </audio>
                                <div class="img-mini row"><img src="${songList[i].img}" alt="@{alt}"></div>
                                <div class="infor-song">
                                    <div class="nameSong">${songList[i].name_song}<img width="12px" height="12px" style="display: none; background-color: rgba: (0,0,0,0); margin-left:10px;"src=""></div>
                                    <div class="author">${songList[i].author}</div>
                                </div> 
                                <div class="more">...</div> 
                            </div>
                        </div>
                         `
                }
                return HTMLs;
            })();
            app.createHTMLForList(``, HTML);
            app.renderStruct('#container-song');
            app.setCurrentSong('.song-tag', 'active');
            app.eventProcessor();
            const control = app.controlBar();
            control.playMusic();
            control.nextSong();
            control.preSong();
            control.randomSong();
            control.loopSong();
            control.changeSong();


        });
    </script>

</body>

</html>